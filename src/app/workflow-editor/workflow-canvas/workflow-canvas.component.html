<div class="app-workflow-canvas">
  <div class="workflow-json-operation clear">
    <div class="workflow-editor">
      <button class="btn btn-icon" (click)="saveWorkflow()" title="Save">
        <clr-icon shape="floppy"></clr-icon>
      </button>
      <button class="btn btn-icon refresh" (click)="refreshWorkflow()" title="Restore">
        <clr-icon shape="sync"></clr-icon>
      </button>
      <app-canvas-graph [onWorkflowInput]='onWorkflowInput' (onWorkflowChanged)="onWorkflowChanged($event)">
      </app-canvas-graph>
    </div>

    <div class="jsoneditor">
      <!--<span class="btn btn-icon float-right" title="Showjson">-->
      <!--<clr-icon shape="view-list"></clr-icon>-->
      <!--</span>-->
      <button class="btn btn-icon " (click)="applyWorkflowJson()" title="Apply">
        <clr-icon shape="two-way-arrows"></clr-icon>
      </button>
      <span class="search-datalist">
        <clr-icon shape="search"></clr-icon>
        <datalist id="workflow_list">
          <select name="workflow">
            <option [ngValue]="wf" *ngFor="let wf of workflows">
              {{wf.friendlyName}}
            </option>
          </select>
        </datalist>
        <input #searchBox type="text" name="workflow" id="workflow" list="workflow_list" style="width: 200px"
           (keyup)="search(searchBox.value)" placeholder="search workflow"
           (click)="getInitTasks()" [(ngModel)]="inputValue"
           (change)="putWorkflowIntoCanvas($event.target.value)">
        <clr-icon shape="times" *ngIf="inputValue" (click)="clearInput()"></clr-icon>
      </span>
      <div #jsoneditor id="jsoneditor"></div>
    </div>
  </div>

  <clr-modal [(clrModalOpen)]="isShowModal" [clrModalSize]="'xl'">
    <h3 class="modal-title" *ngIf="isShowModal">{{saveGraphInfo.status}}</h3>
    <div class="modal-body" *ngIf="isShowModal">
      <p>{{saveGraphInfo.notes | json}}</p>
    </div>
    <div class="modal-footer" *ngIf="isShowModal && saveGraphInfo.type === 1">
      <button class="btn btn-outline" type="button" (click)="isShowModal = false">No,Thanks</button>
      <button class="btn btn-primary" type="button" (click)="jumpRunWorkflow()">Go Now!</button>
    </div>
    <div class="modal-footer" *ngIf="isShowModal && saveGraphInfo.type === 2">
      <button class="btn btn-primary" type="button" (click)="isShowModal = false">Confirm</button>
    </div>
  </clr-modal>

  <clr-modal [(clrModalOpen)]="isWaitOnMismatch" [clrModalSize]="'lg'">
    <h3 class="modal-title">Error Match Task Lable Waiton</h3>
    <div class="modal-body">
      <p>Please check workflow tasks wait on the correct task lable!</p>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-primary btn-danger" (click)="isWaitOnMismatch = false;">OK</button>
    </div>
  </clr-modal>
</div>
