<div class="app-workflow-canvas">
  <div class="workflow-json-operation clear">
    <div class="workflow-editor">
      <button class="btn btn-icon" (click)="saveWorkflow()" title="Save">
        <clr-icon shape="floppy"></clr-icon>
      </button>
      <button class="btn btn-icon refresh" (click)="refreshWorkflow()" title="Restore">
        <clr-icon shape="sync"></clr-icon>
      </button>
      <app-canvas-graph [onWorkflowInput]='onWorkflowInput' (onWorkflowChanged)="onWorkflowChanged($event)">
      </app-canvas-graph>
    </div>

    <div class="editor">
      <div class="row filter-line">
        <button class="btn btn-icon" (click)="applyWorkflowJson()" title="Apply">
          <clr-icon shape="two-way-arrows"></clr-icon>
        </button>
        <div class="dropdown">
          <dropdown-group [data]="workflowStore"
            [columns]="columns" [placeholders]="placeholders"
            [fields]="fields" needSearchIcon=true
            (selected)="onSelected($event)" (cleared)="onRefresh()">
          </dropdown-group>
        </div>
      </div>
      <div #jsoneditor id="jsoneditor"></div>
    </div>
  </div>

  <clr-modal [(clrModalOpen)]="isShowModal" [clrModalSize]="'xl'">
    <h3 class="modal-title" *ngIf="isShowModal">{{saveGraphInfo.status}}</h3>
    <div class="modal-body" *ngIf="isShowModal">
      <p>{{saveGraphInfo.notes | json}}</p>
    </div>
    <div class="modal-footer" *ngIf="isShowModal && saveGraphInfo.type === 1">
      <button class="btn btn-outline" type="button" (click)="isShowModal = false">No</button>
      <button class="btn btn-primary" type="button" (click)="jumpRunWorkflow()">Yes</button>
    </div>
    <div class="modal-footer" *ngIf="isShowModal && saveGraphInfo.type === 2">
      <button class="btn btn-primary" type="button" (click)="isShowModal = false">Confirm</button>
    </div>
  </clr-modal>

  <clr-modal [(clrModalOpen)]="isWaitOnMismatch" [clrModalSize]="'lg'">
    <h3 class="modal-title">Error Match Task Lable Waiton</h3>
    <div class="modal-body">
      <p>Please check workflow tasks wait on the correct task lable!</p>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-primary btn-danger" (click)="isWaitOnMismatch = false;">OK</button>
    </div>
  </clr-modal>
</div>
